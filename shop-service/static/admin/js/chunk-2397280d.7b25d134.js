(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2397280d"],{"0aca":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-page-header",{attrs:{content:"编辑商品信息"},on:{back:e.handleBack}}),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"auto",rules:e.rules}},[r("el-form-item",{attrs:{size:"mini",prop:"name",label:"商品名称"}},[r("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name","string"===typeof t?t.trim():t)},expression:"addForm.name"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"price",label:"商品价格"}},[r("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.addForm.price,callback:function(t){e.$set(e.addForm,"price",e._n(t))},expression:"addForm.price"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"discount",label:"商品折扣"}},[r("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.addForm.discount,callback:function(t){e.$set(e.addForm,"discount",e._n(t))},expression:"addForm.discount"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"count",label:"商品库存"}},[r("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.addForm.count,callback:function(t){e.$set(e.addForm,"count",e._n(t))},expression:"addForm.count"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"goodsTypeId",label:"商品类型"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.addForm.goodsTypeId,callback:function(t){e.$set(e.addForm,"goodsTypeId","string"===typeof t?t.trim():t)},expression:"addForm.goodsTypeId"}},e._l(e.goodsTypeList,(function(e){return r("el-option",{key:""+e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{size:"mini",label:"商品logo",prop:"logo"}},[r("p-upload",{attrs:{"list-type":"picture-card",limit:1,action:"/log/file/upload","before-upload":e.handleBeforeUpload,"on-error":e.handleError},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1),r("el-form-item",{attrs:{size:"mini",label:"商品图片",prop:"pics"}},[r("p-upload",{attrs:{"list-type":"picture-card",limit:3,action:"/log/file/upload","before-upload":e.handleBeforeUpload,"on-error":e.handleError1},model:{value:e.fileList1,callback:function(t){e.fileList1=t},expression:"fileList1"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"description",label:"商品描述"}},[r("el-input",{attrs:{"show-word-limit":"",maxlength:"300",type:"textarea",placeholder:"请输入",clearable:""},model:{value:e.addForm.description,callback:function(t){e.$set(e.addForm,"description",e._n(t))},expression:"addForm.description"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"remark",label:"商品备注"}},[r("el-input",{attrs:{"show-word-limit":"",maxlength:"300",type:"textarea",placeholder:"请输入",clearable:""},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",e._n(t))},expression:"addForm.remark"}})],1),r("el-form-item",{attrs:{size:"mini"}},[r("el-button",{attrs:{loading:e.subLoading,type:"primary"},on:{click:e.handleAdd}},[e._v("提交")])],1)],1)],1)],1)],1)},n=[],a=r("5530"),o=r("1da1"),l=(r("96cf"),r("baa5"),r("d81d"),r("1276"),r("ac1f"),r("a15b"),r("c975"),r("b0c0"),r("d3b7"),r("2f62")),d={name:"goods-add",data:function(){var e=this;return{rules:{name:[{required:!0,message:"请输入商品名称"}],price:[{required:!0,validator:function(e,t,r){t<0?r("商品价格不能为负数"):r()}}],count:[{required:!0,validator:function(e,t,r){t<0?r("库存不能为负数"):r()}}],discount:[{required:!0,validator:function(e,t,r){t<1||t>10?r("商品折扣只能在1-10之间"):r()}}],goodsTypeId:[{required:!0,message:"请选择商品类型"}],logo:[{required:!0,validator:function(t,r,i){e.fileList.length>0&&void 0!=e.fileList[0].url?i():i(new Error("请上传一个logo"))}}],pics:[{required:!0,validator:function(t,r,i){e.fileList1.length>0?i():i(new Error("请上至少上传一个商品图片"))}}],description:[{required:!0,message:"请输入商品描述"}]},fileList:[],fileList1:[],addForm:{name:"",price:0,zheKou:10,goodsTypeId:"",description:"",logo:"",pics:[],remark:"",count:0},subLoading:!1}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$route.query.id,t.next=3,e.getGoodsTypeListAll();case 3:return t.next=5,e.findById(r);case 5:e.addForm=t.sent,e.addForm.logo&&(e.fileList=[{name:e.addForm.logo.substring(e.addForm.logo.lastIndexOf("/")+1),url:e.addForm.logo}]),e.addForm.pics&&(e.fileList1=e.addForm.pics.split(",").map((function(e){return{name:e.substring(e.lastIndexOf("/")+1),url:e}})));case 8:case"end":return t.stop()}}),t)})))()},computed:Object(a["a"])({},Object(l["e"])("goodsModel",["goodsTypeList"])),methods:Object(a["a"])(Object(a["a"])({},Object(l["b"])("goodsModel",["getGoodsTypeListAll","update","findById"])),{},{handleBack:function(){this.$router.history.go(-1)},handleAdd:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.addForm.validate()["catch"]((function(e){return e}));case 2:if(r=t.sent,!r){t.next=11;break}return e.addForm.logo=e.fileList[0].url,e.addForm.pics=e.fileList1.map((function(e){return e.url})).join(","),e.subLoading=!0,t.next=9,e.update(e.addForm);case 9:e.subLoading=!1,e.handleBack();case 11:case"end":return t.stop()}}),t)})))()},handleBeforeUpload:function(e){if(-1==e.name.indexOf("png")&&-1==e.name.indexOf("jpg")&&-1==e.name.indexOf("jpeg")&&-1==e.name.indexOf("gif"))return this.$notify({title:"提示",message:"只能上传图片格式的文件",type:"error"}),Promise.reject()},handleError:function(e){this.$notify({title:"提示",message:"上传logo失败",type:"error"})},handleError1:function(e){this.$notify({title:"提示",message:"上传商品图片失败",type:"error"})}})},s=d,c=r("2877"),u=Object(c["a"])(s,i,n,!1,null,"141576ce",null);t["default"]=u.exports},1276:function(e,t,r){"use strict";var i=r("d784"),n=r("44e7"),a=r("825a"),o=r("1d80"),l=r("4840"),d=r("8aa5"),s=r("50c4"),c=r("14c3"),u=r("9263"),p=r("d039"),m=[].push,f=Math.min,g=4294967295,h=!p((function(){return!RegExp(g,"y")}));i("split",2,(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=String(o(this)),a=void 0===r?g:r>>>0;if(0===a)return[];if(void 0===e)return[i];if(!n(e))return t.call(i,e,a);var l,d,s,c=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,h=new RegExp(e.source,p+"g");while(l=u.call(h,i)){if(d=h.lastIndex,d>f&&(c.push(i.slice(f,l.index)),l.length>1&&l.index<i.length&&m.apply(c,l.slice(1)),s=l[0].length,f=d,c.length>=a))break;h.lastIndex===l.index&&h.lastIndex++}return f===i.length?!s&&h.test("")||c.push(""):c.push(i.slice(f)),c.length>a?c.slice(0,a):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var n=o(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,n,r):i.call(String(n),t,r)},function(e,n){var o=r(i,e,this,n,i!==t);if(o.done)return o.value;var u=a(e),p=String(this),m=l(u,RegExp),b=u.unicode,v=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(h?"y":"g"),x=new m(h?u:"^(?:"+u.source+")",v),y=void 0===n?g:n>>>0;if(0===y)return[];if(0===p.length)return null===c(x,p)?[p]:[];var F=0,k=0,w=[];while(k<p.length){x.lastIndex=h?k:0;var L,I=c(x,h?p:p.slice(k));if(null===I||(L=f(s(x.lastIndex+(h?0:k)),p.length))===F)k=d(p,k,b);else{if(w.push(p.slice(F,k)),w.length===y)return w;for(var O=1;O<=I.length-1;O++)if(w.push(I[O]),w.length===y)return w;k=F=L}}return w.push(p.slice(F)),w}]}),!h)},"44e7":function(e,t,r){var i=r("861d"),n=r("c6b6"),a=r("b622"),o=a("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==n(e))}},a15b:function(e,t,r){"use strict";var i=r("23e7"),n=r("44ad"),a=r("fc6a"),o=r("a640"),l=[].join,d=n!=Object,s=o("join",",");i({target:"Array",proto:!0,forced:d||!s},{join:function(e){return l.call(a(this),void 0===e?",":e)}})},baa5:function(e,t,r){var i=r("23e7"),n=r("e58c");i({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},e58c:function(e,t,r){"use strict";var i=r("fc6a"),n=r("a691"),a=r("50c4"),o=r("a640"),l=Math.min,d=[].lastIndexOf,s=!!d&&1/[1].lastIndexOf(1,-0)<0,c=o("lastIndexOf"),u=s||!c;e.exports=u?function(e){if(s)return d.apply(this,arguments)||0;var t=i(this),r=a(t.length),o=r-1;for(arguments.length>1&&(o=l(o,n(arguments[1]))),o<0&&(o=r+o);o>=0;o--)if(o in t&&t[o]===e)return o||0;return-1}:d}}]);
//# sourceMappingURL=chunk-2397280d.7b25d134.js.map