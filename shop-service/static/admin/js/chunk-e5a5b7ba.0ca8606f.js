(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e5a5b7ba"],{"98f4":function(e,t,a){},c08a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("p-page-header",{attrs:{title:"考勤范围设置"}}),a("p-map")],1)},r=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(" 在考勤范围中输入考勤范围然后点击地图设置考勤位置 ")]),a("el-form",{attrs:{inline:"",size:"mini"}},[a("el-form-item",{attrs:{label:"国家"}},[a("el-input",{attrs:{readonly:""},model:{value:e.addressInfo.nation,callback:function(t){e.$set(e.addressInfo,"nation",t)},expression:"addressInfo.nation"}})],1),a("el-form-item",{attrs:{label:"省"}},[a("el-input",{attrs:{readonly:""},model:{value:e.addressInfo.province,callback:function(t){e.$set(e.addressInfo,"province",t)},expression:"addressInfo.province"}})],1),a("el-form-item",{attrs:{label:"市"}},[a("el-input",{attrs:{readonly:""},model:{value:e.addressInfo.city,callback:function(t){e.$set(e.addressInfo,"city",t)},expression:"addressInfo.city"}})],1),a("el-form-item",{attrs:{label:"区"}},[a("el-input",{attrs:{readonly:""},model:{value:e.addressInfo.district,callback:function(t){e.$set(e.addressInfo,"district",t)},expression:"addressInfo.district"}})],1),a("el-form-item",{attrs:{label:"纬度"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{readonly:"",value:e.lat}})],1),a("el-form-item",{attrs:{label:"经度"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{readonly:"",value:e.lng}})],1),a("el-form-item",{attrs:{label:"考勤区范围(km)"}},[a("el-input",{attrs:{type:"number",step:"0.1",min:"0.5",max:"3"},model:{value:e.r,callback:function(t){e.r=e._n(t)},expression:"r"}})],1),a("el-form",{attrs:{inline:""}},[a("el-form-item",{attrs:{label:"上班时间"}},[a("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"08:30",step:"00:15",end:"18:30"},"value-format":"hhmm"},model:{value:e.addressInfo.beginTime,callback:function(t){e.$set(e.addressInfo,"beginTime",t)},expression:"addressInfo.beginTime"}})],1),a("el-form-item",{attrs:{label:"下班时间"}},[a("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"08:30",step:"00:15",end:"18:30",minTime:e.addressInfo.beginTime},"value-format":"hhmm"},model:{value:e.addressInfo.endTime,callback:function(t){e.$set(e.addressInfo,"endTime",t)},expression:"addressInfo.endTime"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-upload",type:"primary"},on:{click:e.handleSubmit}},[e._v("设置")])],1)],1)],1),a("div",{ref:"map",staticClass:"map"})],1)},i=[],o=a("5530"),l=a("1da1"),c=(a("d81d"),a("96cf"),a("db04")),d=a("4328"),u=a.n(d),p=function(e){return c["a"].http.jsonp("https://apis.map.qq.com/ws/location/v1/ip?"+u.a.stringify(e))},m=function(e){return c["a"].http.jsonp("https://apis.map.qq.com/ws/geocoder/v1/?"+u.a.stringify(e))},f=function(){return c["a"].http({url:"/check-out/get/position",method:"get"})["catch"]((function(e){return e}))},h=function(e){return c["a"].http({url:"/check-out/update/position",method:"put",data:e})["catch"]((function(e){return e}))},g={name:"p-map",data:function(){return{lat:0,lng:0,addressInfo:{},r:1,center:{},map:{},circle:{},marker:{}}},mounted:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:if(a=t.sent,200!=a.data.code){t.next=7;break}n={status:0,result:{ad_info:Object(o["a"])({},a.data.data),location:{lat:a.data.data.lat,lng:a.data.data.lng}}},t.next=10;break;case 7:return t.next=9,p({key:"PN2BZ-XWHW2-ZIAU7-CQW7K-LSY4J-WYBOO",output:"jsonp"});case 9:n=t.sent;case 10:console.log(n),0==n.status&&(e.lat=n.result.location.lat,e.lng=n.result.location.lng,e.addressInfo=n.result.ad_info,e.r=n.result.ad_info.r?n.result.ad_info.r:1,e.initMap());case 12:case"end":return t.stop()}}),t)})))()},watch:{r:function(e){this.drawCircle(),this.drawMarker()}},methods:{initMap:function(){var e=this;this.center=new TMap.LatLng(this.lat,this.lng),this.map=new TMap.Map(this.$refs.map,{center:this.center,zoom:12,pitch:0,rotation:0}),this.drawCircle(),this.drawMarker(),this.map.on("click",(function(t){console.log(t),e.$confirm("正在设置新的考勤地点是否继续","提示",{type:"warning"}).then((function(e){return m({location:t.latLng.lat+","+t.latLng.lng,key:"PN2BZ-XWHW2-ZIAU7-CQW7K-LSY4J-WYBOO",output:"jsonp"})})).then((function(a){console.log(a),0==a.status&&(e.lat=t.latLng.lat,e.lng=t.latLng.lng,e.center=new TMap.LatLng(e.lat,e.lng),e.addressInfo=Object(o["a"])(Object(o["a"])({},e.addressInfo),a.result.address_component),e.drawCircle(),e.drawMarker())}))["catch"]((function(e){return e}))}))},drawCircle:function(){this.circle.setMap&&this.circle.setMap(null),this.circle=new TMap.MultiCircle({map:this.map,styles:{circle:new TMap.CircleStyle({color:"rgba(41,91,255,0.16)",showBorder:!0,borderColor:"rgba(41,91,255,1)",borderWidth:2})},geometries:[{styleId:"circle",center:this.center,radius:this.r?1e3*this.r:0}]})},drawMarker:function(){this.marker.setMap&&this.marker.setMap(null),this.marker=new TMap.MultiMarker({id:"marker-layer",map:this.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},geometries:[{id:"demo",styleId:"marker",position:this.center,properties:{title:"marker"}}]})},handleSubmit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(o["a"])(Object(o["a"])({},e.addressInfo),{},{lat:e.lat,lng:e.lng,id:"001",r:e.r}),console.log(a),t.next=4,h(a);case 4:n=t.sent,200==n.data.code&&e.$notify.success({title:"提示",message:"设置成功"});case 6:case"end":return t.stop()}}),t)})))()}}},b=g,k=(a("c5d5"),a("2877")),w=Object(k["a"])(b,s,i,!1,null,"41d9ca1a",null),v=w.exports,y={name:"check-scope",components:{PMap:v},created:function(){}},I=y,M=Object(k["a"])(I,n,r,!1,null,null,null);t["default"]=M.exports},c5d5:function(e,t,a){"use strict";a("98f4")}}]);
//# sourceMappingURL=chunk-e5a5b7ba.0ca8606f.js.map