(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a26244c"],{"3be4":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-page-header",{attrs:{content:"修改新闻信息"},on:{back:e.handleBack}}),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"auto",rules:e.rules}},[r("el-form-item",{attrs:{size:"mini",prop:"name",label:"新闻名称"}},[r("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name","string"===typeof t?t.trim():t)},expression:"addForm.name"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"newsTypeId",label:"新闻类型"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.addForm.newsTypeId,callback:function(t){e.$set(e.addForm,"newsTypeId","string"===typeof t?t.trim():t)},expression:"addForm.newsTypeId"}},e._l(e.newsTypeList,(function(e){return r("el-option",{key:""+e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{size:"mini",label:"新闻logo",prop:"logo"}},[r("p-upload",{attrs:{"list-type":"picture-card",limit:1,action:"/file/upload","before-upload":e.handleBeforeUpload,"on-error":e.handleError},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"description",label:"新闻描述"}},[r("el-input",{attrs:{"show-word-limit":"",maxlength:"300",type:"textarea",placeholder:"请输入",clearable:""},model:{value:e.addForm.description,callback:function(t){e.$set(e.addForm,"description",e._n(t))},expression:"addForm.description"}})],1),r("el-form-item",{attrs:{size:"mini",prop:"content",label:"新闻内容"}},[r("p-editor",{attrs:{height:"300px","img-type":"upload"},model:{value:e.addForm.content,callback:function(t){e.$set(e.addForm,"content",t)},expression:"addForm.content"}})],1),r("el-form-item",{attrs:{size:"mini"}},[r("el-button",{attrs:{loading:e.subLoading,type:"primary"},on:{click:e.handleAdd}},[e._v("提交")])],1)],1)],1)],1)],1)},a=[],o=r("5530"),i=r("1da1"),l=(r("96cf"),r("baa5"),r("c975"),r("b0c0"),r("d3b7"),r("ceb0")),s=r("2f62"),d={components:{PEditor:l["a"]},name:"goods-add",data:function(){var e=this;return{rules:{name:[{required:!0,message:"请输入新闻名称"}],newsTypeId:[{required:!0,message:"请选择新闻类型"}],logo:[{required:!0,validator:function(t,r,n){e.fileList.length>0&&void 0!=e.fileList[0].url?n():n(new Error("请上传一个logo"))}}],description:[{required:!0,message:"请输入新闻描述"}],content:[{required:!0,message:"请输入新闻内容"}]},fileList:[],addForm:{name:"",newsTypeId:"",description:"",logo:""},subLoading:!1}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$route.query.id,t.next=3,e.getNewsTypeListAll();case 3:return t.next=5,e.findById(r);case 5:e.addForm=t.sent,e.fileList=[{name:e.addForm.logo.substring(e.addForm.logo.lastIndexOf("/")+1),url:e.addForm.logo}];case 7:case"end":return t.stop()}}),t)})))()},computed:Object(o["a"])({},Object(s["e"])("newsModel",["newsTypeList"])),methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])("newsModel",["getNewsTypeListAll","update","findById"])),{},{handleBack:function(){this.$router.history.go(-1)},handleAdd:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.addForm.validate()["catch"]((function(e){return e}));case 2:if(r=t.sent,!r){t.next=10;break}return e.addForm.logo=e.fileList[0].url,e.subLoading=!0,t.next=8,e.update(e.addForm);case 8:e.subLoading=!1,e.handleBack();case 10:case"end":return t.stop()}}),t)})))()},handleBeforeUpload:function(e){if(-1==e.name.indexOf("png")&&-1==e.name.indexOf("jpg")&&-1==e.name.indexOf("jpeg")&&-1==e.name.indexOf("gif"))return this.$notify({title:"提示",message:"只能上传图片格式的文件",type:"error"}),Promise.reject()},handleError:function(e){this.$notify({title:"提示",message:"上传logo失败",type:"error"})},handleError1:function(e){this.$notify({title:"提示",message:"上传新闻图片失败",type:"error"})}})},c=d,u=r("2877"),m=Object(u["a"])(c,n,a,!1,null,"0c6a499a",null);t["default"]=m.exports},baa5:function(e,t,r){var n=r("23e7"),a=r("e58c");n({target:"Array",proto:!0,forced:a!==[].lastIndexOf},{lastIndexOf:a})},e58c:function(e,t,r){"use strict";var n=r("fc6a"),a=r("a691"),o=r("50c4"),i=r("a640"),l=Math.min,s=[].lastIndexOf,d=!!s&&1/[1].lastIndexOf(1,-0)<0,c=i("lastIndexOf"),u=d||!c;e.exports=u?function(e){if(d)return s.apply(this,arguments)||0;var t=n(this),r=o(t.length),i=r-1;for(arguments.length>1&&(i=l(i,a(arguments[1]))),i<0&&(i=r+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:s}}]);
//# sourceMappingURL=chunk-5a26244c.ac248b4c.js.map